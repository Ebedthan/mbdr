{"title":"Exploration des données","markdown":{"headingText":"Exploration des données","containsRefs":false,"markdown":"\nLa phase initiale de l'analyse des données implique une exploration graphique de l'ensemble des données en répondant aux questions suivantes :\n\n-   Quelle est la tendance centrale des données ? Comment les données sont-elles distribuées ? La distribution est-elle symétrique, asymétrique ou bimodale ?\n-   Y a-t-il des valeurs aberrantes dans l'ensemble des données ?\n-   Les variables suivent-elles une distribution normale ?\n-   Existe-t-il des relations entre les variables ? Ces relations sont-elles linéaires ? Quelles sont les analyses ultérieures à effectuer ?\n-   Une transformation des données est-elle nécessaire ?\n-   L'effort d'échantillonnage a-t-il été approximativement égal pour chaque observation ou variable ?\n\nEn explorant systématiquement ces questions, nous pouvons acquérir une compréhension globale des caractéristiques de l'ensemble de données et guider l'orientation des analyses ultérieures.\n\n## Outils graphiques\n\n### Boîte à moustache\n\nUn diagramme en boîte, ou boîte à moustaches, permet de visualiser la moyenne et la dispersion d'une variable univariée. Normalement, le point central d'un diagramme en boîte est la médiane, mais il peut également s'agir de la moyenne. Les quartiles 25% et 75% (Q25 et Q75) définissent les charnières (extrémités des boîtes), et la différence entre les charnières est appelée l'écart. Des lignes (ou moustaches) sont tracées à partir de chaque charnière jusqu'à 1,5 fois l'écart ou jusqu'à la valeur la plus extrême de l'écart, la plus petite étant retenue. Tous les points situés en dehors de ces valeurs sont normalement identifiés comme des valeurs aberrantes @fig-boxplot.\n\n![Boîte à moustache](boxplot.png){#fig-boxplot fig-align=\"center\" width=\"500\"}\n\n```{r, echo=FALSE}\npenguins <- palmerpenguins::penguins\n```\n\n::: callout-note\nLa syntaxe générale pour créer la boîte à moustache d'une variable en utilisant base R est: `boxplot(variable).`\n\nL'aide complète de la fonction `boxplot()` est obtenue par la commande `?boxplot()`.\n:::\n\nEtudions la variable `body_mass_g` en représentant sa boîte à moustache.\n\n``` {r}\nboxplot(penguins$body_mass_g, xlab=\"Masse (g)\")\n```\n\nOn remarque qu'aucune valeur aberrante n'apparait de façon visible. De plus on observe que la médiane du poids des manchots se situent autour de 4000 g (on peut facilement confirmer cela en calculant la médiane `median(penguins$body_mass_g)`).\n\nOn peut alors être amenée à continuer l'exploration en étudiant le poids, cette fois-ci en étudiant la variable par espèce de manchot.\n\n```{r}\nboxplot(body_mass_g ~ species, data=penguins, ylab=\"Masse (g)\", xlab=NULL)\n```\n\nLes boîte à moustaches representées nous permettent de nous rendre compte que l'espèce Gentoo a sensiblement une masse plus élevée que les deux autres. On pourra confirmer si cette différence est significative avec une analyse de variance. De plus, on observe la présence de quelques valeurs aberrantes chez l'espèce Chinstrap.\n\n### Diagramme de points de Cleveland\n\nLes diagrammes de points de Cleveland sont utiles pour identifier les valeurs aberrantes et l'homogénéité.\n\nL'homogénéité signifie que la variance des données ne change pas le long des gradients. La violation de cette condition est appelée hétérogénéité et l'homogénéité est une hypothèse cruciale pour de nombreuses méthodes statistiques.\n\nLa valeur est présentée sur l'axe horizontal et l'ordre des points (tel qu'il est organisé par le programme) est présenté sur l'axe vertical.\n\n::: callout-note\nLa syntaxe pour générer un nuage de points avec base R est `dotchart(variable)`. L'aide est disponible avec la commande `?dotchart()`.\n:::\n\nRepresentons le nuage de point de Cleveland avec pour but d'identifier une possible violation de l'homogénéité ou la présence de valeurs aberrantes. Le diagrammes à points est réalisé en utilisant différents symboles conditionnels à une variable explicative nominale qui est ici l'espèce.\n\n```{r}\ndotchart(penguins$body_mass_g, main=\"Masse (g)\", pch=as.numeric(penguins$species))\n```\n\nTout point isolé à droite ou à gauche indique des valeurs aberrantes, mais dans cet jeu de données, en considérant l'ensemble du graphique aucun point n'est considéré comme aberrant, ce qui confirme notre observation de la boîte à moustache.\nCependant comme observé plus haut, en prenant les points par groupe (chaque symbole représentant une espèce différente) on observe bien un groupe présentant des valeurs aberrantes.\n\n\n### Histogramme\n\nUn histogramme montre le centre et la distribution des données et donne une indication de la normalité. Toutefois, l'application d'une transformation des données pour les faire correspondre à une distribution normale nécessite des précautions.\n\n```{r}\n# Subdivision du panel graphique\nlayout(matrix(c(1, 2, 1, 3), nrow = 2, byrow = TRUE))\n\n# Histrogramme de la masse pour l'ensemble des manchots\nhist(penguins$body_mass_g, main=\"Masse (g)\", xlab=NULL)\n\n# Histrogramme de la masse pour les males\nhist(penguins$body_mass_g[penguins$sex==\"male\"], main=\"Males\", xlab=NULL)\n# Histrogramme de la masse pour les femelles\nhist(penguins$body_mass_g[penguins$sex==\"female\"], main=\"Females\", xlab=NULL)\n```\n\nLa forme de l'histogramme montre une certaine asymétrie et l'on pourrait être tenté d'appliquer une transformation. Cependant, un histogramme conditionnel donne une image assez différente. Dans un histogramme conditionnel, les données sont divisées en fonction d'une variable nominale et les histogrammes des sous-ensembles sont tracés côte-à-côte. A ce moment on obtient une figure tout autre montrant une bimodalité aussi bien chez les males que chez les femelles manchots. On a une différence claire du centre de la distribution et la pic initial de données observé sur le premier histogramme est grandement du aux femelles. Il faudrait donc explorer les effets du sexe sur le poids des manchots ainsi que les interactions avant d'envisager une transformation des données.\n\n\n### QQ-plots\n\nUn graphique Quantile-Quantile (QQ-plots) est un outil graphique utilisé pour déterminer si les données suivent une distribution particulière. Le graphique QQ pour une distribution normale compare la distribution d'une variable donnée à la distribution gaussienne. Si les points obtenus se situent approximativement sur une ligne droite, on considère que la distribution des données est la même que celle d'une variable normalement distribuée.\n\nLe $p$-ème quantile $q$ d'une variable aléatoire $y$ est donnée par $F(q) = P(y \\leq q) = p$. Si l'on souhaire savoir quelle valeur de $q$ appartient à $p$, on inverse la formule précédente pour obtenir $q = F^{-1}(p)$. \nSupposons que nous avons cinq observations $Y_i$ avec les valeurs 1, 2, 3, 4, 5. Par définition, le premier chiffre est le 0% percentile, le milieu est le 50% percentile et 5 est le 100% percentile. La différence entre un quantile et un percentile est un seulement le facteur 100. Les QQ-plots sont soit basés sur les percentiles ou typiquement sur les points quantiles de l'échantillon définis par $(i-0.5)/n$ où $i$ varie de 1 à 5 et $n=5$ dans notre example. Ainsi pour notre exemple, les points de quantiles de l'échantillon sont 0,1, 0,3, 0,5, 0,7 et 0,9. Ce sont les valeurs de $p$ pour l'échantillon. Dans la séconde étape, ces quantiles de l'échantillon sont comparés à une distribution normale. Celà signifie que la fonction de densité $P(y\\leq q)$ est désormais une fonction de densité normale et $F()$ est désormais la fonction de répartition de la loi normale. \n\nLe QQ-plot est donc un graphique des valeurs de $Y_i$ de l'échantillon comparés aux $q_i$. \nOn peut ajouter à ce graphique dans R, une ligne qui connecte les 25e et le 75e quartiles.\n\nNous appliquons dans le même temps une transformation des données pour visualiser laquelle produit le meilleur ajustement.\n\nIl est très souvent utilse de combiner les QQ-plots avec des transformations de puissance, qui est donnée par $$ \\frac{Y^p - 1}{p}, \\forall p \\neq 0; log(Y) , p = 0$$\n\nVeuillez noter que le $p$ utilisé ici n'est pas le $p$ utilisé pour décrire les quantiles. Il est aussi utile de comparer plusieurs QQ-plots pour différentes valeurs de $p$.\n\n```{r}\n# Transformation racine carrée\nbmsq <- sqrt(penguins$body_mass_g)\n# Transformation racine quatrième\nbmfq <- penguins$body_mass_g^(0.25)\n# Transformation logarithmique\nbmlog <- log(penguins$body_mass_g)\n```\n\nDans le graphique ci-dessous, aucune transormation semble prendre le dessus sur l'autre.\n\n```{r}\nlayout(matrix(c(1, 2, 3, 4), nrow = 2, byrow = TRUE))\nqqnorm(penguins$body_mass_g, main=\"Aucune transformation (p=0)\")\nqqline(penguins$body_mass_g)\nqqnorm(bmsq, main=\"Racine carré (p=0.5)\")\nqqline(bmsq)\nqqnorm(bmfq, main=\"Racine quatrième (p=0.25)\")\nqqline(bmfq)\nqqnorm(bmlog, main=\"Logarithme (p=1)\")\nqqline(bmlog)\n```\n\n### Nuage de points\n\nJusqu'à présent, l'accent a été mis sur la détection des valeurs aberrantes, la vérification de la normalité et l'exploration d'ensembles de données associés à des variables explicatives nominales uniques. \nLes techniques suivantes s'intéressent aux relations entre plusieurs variables. Un nuage de points est un outil permettant de trouver une relation entre deux variables. Il représente une variable sur l'axe horizontal et une seconde variable sur l'axe vertical. Pour aider à visualiser la relation entre les variables, une ligne droite ou une courbe de lissage est souvent ajoutée au graphique.\n\n```{r}\nplot(penguins$flipper_length_mm, penguins$body_mass_g, xlab=\"Taille des nageoires\", ylab=\"Masse (g)\")\nm1 <- lm(body_mass_g ~ flipper_length_mm, data=penguins)\nabline(m1)\n```\n\n\n### Pairplots\n\nSi vous avez plus de deux variables, vous pouvez produire une série de nuage de points : un pour chaque paire de variables. Cependant, le nombre de diagrammes augmente rapidement si vous avez plus de trois variables à explorer. Une meilleure approche, jusqu'à environ 10 variables explicatives, est le diagramme de paires encore appelée matrice de nuage de points. Ces diagrammes présentent plusieurs nuage de points par paire dans un seul graphique et peuvent être utilisés pour détecter les relations entre les variables et pour détecter la colinéarité.\n\n```{r}\n# penguins[3:6] sélectionne les variables bill_length_mm\n# bill_depth_mm, flipper_length_mm, body_mass_g\npairs(penguins[,3:6])\n```\n\n### Coplot\n\nUn coplot est un nuage de points conditionnel montrant la relation entre y et x, pour différentes valeurs d'une troisième variable z, voire d'une quatrième variable w. Les variables conditionnelles peuvent être nominales ou continues.\n\n```{r, warning=FALSE}\ncoplot(body_mass_g ~ flipper_length_mm | species, data = penguins)\n```\n\n### Diagrammes de conception et d'interaction\n\nLes diagrammes de conception et d'interaction sont un autre outil précieux pour explorer les ensembles de données avec des variables nominales et sont particulièrement utiles à utiliser avant d'appliquer la régression, la GLM, la modélisation mixte ou l'ANOVA. Ils permettent de visualiser (i) les différences entre les valeurs moyennes de la variable réponse pour différents niveaux de variables nominales et (ii) les interactions entre les variables explicatives.\n\n```{r}\nplot.design(body_mass_g ~ species + sex + island, data = penguins)\n```\n\n```{r}\ninteraction.plot(penguins$species, penguins$sex, penguins$body_mass_g)\n```\n\n```{r}\ninteraction.plot(penguins$sex, penguins$island, penguins$body_mass_g)\n```\n\n## Valeurs aberrantes, transformations et standardisation\n\n### Valeurs aberrantes\n\nUne valeur aberrante est un point de données qui, en raison de sa valeur extrême par rapport au reste de l'ensemble de données, peut influencer incorrectement une analyse. La première question qui se pose est donc la suivante : « Comment identifier une valeur aberrante ? Une approche simple pourrait consister à quantifier tout ce qui est aberrant au-delà d'une certaine distance par rapport au centre des données.\n\n### Transformation\n\nIl existe de nombreuses raisons de transformer les données, mais c'est généralement parce que les données présentent des valeurs extrêmes aberrantes et des distributions non normales. La transformation des données (sur les variables de réponse) sera également nécessaire lorsque vous prévoyez d'utiliser l'analyse discriminante et qu'il existe des preuves évidentes (par exemple, en utilisant un diagramme en pointillés de Cleveland) de l'hétérogénéité.\n\nDe plus, le choix de la transformation est influencée par le choix de l'analyse de suivi. Pour certaines techniques, telles que les arbres de classification ou de régression, la transformation des variables explicatives ne change rien aux résultats. Cependant, la plupart des techniques peuvent nécessiter une certaine transformation des données brutes avant l'analyse.\n\n### Standardisation\n\nSi les variables comparées proviennent d'échelles très différentes, comme la comparaison des taux de croissance de petites espèces de poissons avec ceux de grandes espèces de poissons, la standardisation (conversion de toutes les variables à la même échelle) peut être une option. Toutefois, cela dépend de la technique statistique utilisée.\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"exploration.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.361","bibliography":["references.bib"],"editor":"visual","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"exploration.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"editor":"visual","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}