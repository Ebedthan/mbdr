<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anicet Ebou">

<title>Modélisation des données biologiques avec R - 4&nbsp; Regression linéaire</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./glm.html" rel="next">
<link href="./exploration.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./regression.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression linéaire</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modélisation des données biologiques avec R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Ebedthan/mbdr/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bienvenue</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Présentation des jeux de données</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organigram.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Organigramme de relation entre les outils d’analyse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exploration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploration des données</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression linéaire</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modèles linéaires généralisés</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modèles additifs généralisés</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#présentation-de-lanalyse" id="toc-présentation-de-lanalyse" class="nav-link" data-scroll-target="#présentation-de-lanalyse"><span class="header-section-number">4.2</span> Présentation de l’analyse</a></li>
  <li><a href="#modélisation" id="toc-modélisation" class="nav-link" data-scroll-target="#modélisation"><span class="header-section-number">4.3</span> Modélisation</a>
  <ul class="collapse">
  <li><a href="#visualisation-des-résultats" id="toc-visualisation-des-résultats" class="nav-link" data-scroll-target="#visualisation-des-résultats"><span class="header-section-number">4.3.1</span> Visualisation des résultats</a></li>
  <li><a href="#sélection-de-modèle" id="toc-sélection-de-modèle" class="nav-link" data-scroll-target="#sélection-de-modèle"><span class="header-section-number">4.3.2</span> Sélection de modèle</a></li>
  <li><a href="#exercice" id="toc-exercice" class="nav-link" data-scroll-target="#exercice"><span class="header-section-number">4.3.3</span> Exercice</a></li>
  <li><a href="#validation-de-modèle" id="toc-validation-de-modèle" class="nav-link" data-scroll-target="#validation-de-modèle"><span class="header-section-number">4.3.4</span> Validation de modèle</a></li>
  <li><a href="#visualisation-du-modèle" id="toc-visualisation-du-modèle" class="nav-link" data-scroll-target="#visualisation-du-modèle"><span class="header-section-number">4.3.5</span> Visualisation du modèle</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression linéaire</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">4.1</span> Introduction</h2>
<p>Au chapitre précédent, nous avons utilisé divers outils graphiques (diagrammes en points de Cleveland, boîte à moustache, histogrammes) pour explorer la forme de nos données (normalité), rechercher la présence de valeurs aberrantes et évaluer la nécessité de transformer les données.</p>
<p>Nous avons également abordé des méthodes plus complexes (coplot, scatterplot, pairplots) qui ont permis de voir les relations entre une seule variable de réponse et plus d’une variable explicative. Il s’agit de la première étape essentielle de toute analyse qui permet de se faire une idée sur les données avant de passer à des outils statistiques formels tels que la régression linéaire.</p>
<p>Tous les jeux de données ne se prêtent pas à la régression linéaire. Pour les données de comptage ou de présences-absences, la modélisation linéaire généralisée (GLM) est plus appropriée. Et lorsque les modèles paramétriques utilisés par la régression linéaire et la GLM donnent de mauvais résultats, les techniques non paramétriques telles que la modélisation additive et la modélisation additive généralisée (GAM) sont susceptibles de donner de meilleurs résultats.</p>
<p>Les techniques telles que le GLM et le GAM sont plus difficiles à comprendre et à mettre en œuvre. C’est pourquoi nous commencerons donc par résumer brièvement les principes sous-jacents de la modélisation linéaire.</p>
</section>
<section id="présentation-de-lanalyse" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="présentation-de-lanalyse"><span class="header-section-number">4.2</span> Présentation de l’analyse</h2>
<p>Avant de taper avec enthousiasme le code R pour la régression linéaire et de l’exécuter, nous devrions d’abord réfléchir à ce que nous voulons faire. Le but de l’analyse est de trouver une relation entre les densités d’oiseaux (<code>abundance</code>) et les six variables explicatives. Mais il se pourrait bien que les oiseaux perçoivent l’effet <code>area</code> différemment selon que les valeurs de <code>graze</code> sont faibles ou élevées. Si c’est le cas, nous devons inclure un terme d’interaction entre <code>graze</code> et <code>larea</code>. Le problème est qu’il existe un grand nombre d’interactions bidirectionnelles potentielles. Les oiseaux peuvent réagir différemment à area si les valeurs de <code>graze</code> sont faibles en combinaison avec de faibles valeurs d’altitude (<code>altitude</code>). Plus l’ensemble de données est petit (56 observations, c’est petit), plus il est difficile d’inclure de multiples interactions.</p>
<p>Il peut arriver que vous ne disposiez pas d’un nombre suffisant d’observations par combinaison. Dans ce cas, les observations individuelles peuvent devenir particulièrement influentes. De nombreux groupes de discussion statistiques ont de longs fils de discussion sur le sujet de l’interaction, voici les points que je vous recommande:</p>
<ol type="1">
<li>Commencer par un modèle sans interactions. Appliquer le modèle, la sélection du modèle et la validation du modèle. Si la validation montre qu’il existe des motifs dans les résidus, cherchez-en la raison. L’ajout d’interactions peut être une option pour améliorer le modèle.</li>
<li>Utiliser les connaissances biologiques pour décider quelles sont les interactions qu’il est judicieux d’ajouter, le cas échéant.</li>
<li>Appliquer une bonne exploration des données pour voir quelles interactions peuvent être importantes.</li>
</ol>
</section>
<section id="modélisation" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="modélisation"><span class="header-section-number">4.3</span> Modélisation</h2>
<p>Nous débutons l’analyse avec un modèle sans interactions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>loyn <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Loyn.txt"</span>, <span class="at">header=</span>T)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>loyn<span class="sc">$</span>larea <span class="ot">&lt;-</span> <span class="fu">log</span>(loyn<span class="sc">$</span>area)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>loyn<span class="sc">$</span>ldist <span class="ot">&lt;-</span> <span class="fu">log</span>(loyn<span class="sc">$</span>distance)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>loyn<span class="sc">$</span>lldist <span class="ot">&lt;-</span> <span class="fu">log</span>(loyn<span class="sc">$</span>ldistance)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>loyn<span class="sc">$</span>fgraze <span class="ot">&lt;-</span> <span class="fu">factor</span>(loyn<span class="sc">$</span>graze)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(abundance <span class="sc">~</span> larea <span class="sc">+</span> ldist <span class="sc">+</span> lldist <span class="sc">+</span> year <span class="sc">+</span> altitude <span class="sc">+</span> fgraze, <span class="at">data =</span> loyn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La question qui se pose maintenant est la suivante : Devons-nous examiner d’abord la sortie numérique ou la sortie graphique ? Il est inutile d’appliquer une validation détaillée du modèle si rien n’est significatif. D’un autre côté, pourquoi examiner les résultats numériques si toutes les hypothèses ne sont pas respectées ? Il est peut-être préférable de commencer par les résultats numériques, car cela prend moins de temps et c’est plus facile. Il existe plusieurs façons d’obtenir le résultat numérique de notre modèle de régression linéaire.</p>
<section id="visualisation-des-résultats" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="visualisation-des-résultats"><span class="header-section-number">4.3.1</span> Visualisation des résultats</h3>
<section id="évaluation-de-la-signification-des-paramètres-de-régression" class="level4" data-number="4.3.1.1">
<h4 data-number="4.3.1.1" class="anchored" data-anchor-id="évaluation-de-la-signification-des-paramètres-de-régression"><span class="header-section-number">4.3.1.1</span> Évaluation de la signification des paramètres de régression</h4>
<p>Un aspect important de la régression linéaire est la répartition de la variabilité totale. La variance totale de <span class="math inline">\(Y\)</span>, désignée par <span class="math inline">\(SS_{total}\)</span>, peut être divisée en deux parties: la partie expliquée par <span class="math inline">\(X\)</span> (<span class="math inline">\(SS_{régression}\)</span>) et la partie non expliquée par <span class="math inline">\(X\)</span> (<span class="math inline">\(SS_{résidual}\)</span>). <span class="math inline">\(SS_{regression}\)</span> mesure à quel point la partie régression (<span class="math inline">\(X\)</span>) explique <span class="math inline">\(Y\)</span>, et <span class="math inline">\(SS_{residual}\)</span> montre la quantité de variabilité dans les valeurs <span class="math inline">\(Y\)</span> qui ne peut être expliquée par le modèle de régression. La plupart des programmes statistiques produisent des tableaux ANOVA de la forme suivante.</p>
<table class="table">
<colgroup>
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Source de variation</th>
<th>Somme des carrés</th>
<th>Degré de liberté</th>
<th>Somme des carrés moyens</th>
<th>Somme des carrés moyens attendu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td><span class="math display">\[                                
                       \sum^n_{i=1}(\hat Y_i - \bar Y)^2  
                       \]</span></td>
<td><span class="math display">\[               
                                                           1                 
                                                           \]</span></td>
<td><span class="math display">\[                                          
                                                                              \sum^n_{i=1}\frac{(\hat Y_i - \bar Y)^2}{1}  
                                                                              \]</span></td>
<td><span class="math display">\[                                                           
                                                                                                                            \sigma^2_\epsilon + \beta^2\sum^n_{i=1}(\hat X_i - \bar X)^2  
                                                                                                                            \]</span></td>
</tr>
<tr class="even">
<td>Residus</td>
<td><span class="math display">\[                                
                       \sum^n_{i=1}(Y_i - \hat Y_i)^2     
                       \]</span></td>
<td><span class="math display">\[               
                                                           n-2               
                                                           \]</span></td>
<td><span class="math display">\[                                          
                                                                              \sum^n_{i=1}\frac{(Y_i - \hat Y_i)^2}{n-2}   
                                                                              \]</span></td>
<td><span class="math display">\[                                                           
                                                                                                                            \sigma^2_\epsilon                                             
                                                                                                                            \]</span></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math display">\[                                
                       \sum^n_{i=1}(Y_i - \bar Y)^2       
                       \]</span></td>
<td><span class="math display">\[               
                                                           n-1               
                                                           \]</span></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>La somme des carrés dépend de la taille de l’échantillon <span class="math inline">\(n\)</span>. Si l’on utilise davantage d’observations, les sommes des carrés sont plus importantes. Par conséquent, les sommes des carrés sont transformées en composantes de variance en les divisant par les degrés de liberté. Les degrés de liberté pour la somme des carrés de régression sont le nombre de paramètres de régression moins 1. Les degrés de liberté pour la somme totale des carrés est <span class="math inline">\(n - 1\)</span>. S’il n’y avait pas de variables explicatives, la variance serait estimée à partir du rapport entre la somme totale des carrés et <span class="math inline">\(n - 1\)</span>.</p>
<p>Les degrés de liberté pour la somme des carrés résiduels est <span class="math inline">\(n - 2\)</span>; deux paramètres de régression ont été estimés pour calculer cette composante: l’ordonnée à l’origine et la pente. Le rapport des deux composantes de la variance est appelé carré moyen (MS). Les MS sont des variances d’échantillon et, par conséquent, des paramètres d’estimation. <span class="math inline">\(MS_{residual}\)</span> estime <span class="math inline">\(\sigma^2_\epsilon\)</span> et <span class="math inline">\(MS_{regression}\)</span> estime <span class="math inline">\(\sigma^2_\epsilon\)</span> plus un terme supplémentaire dépendant de <span class="math inline">\(\beta\)</span> et <span class="math inline">\(X\)</span>.</p>
<p>Dans la régression bivariée, le tableau ANOVA est utilisé pour tester l’hypothèse nulle selon laquelle la pente de la ligne de régression est égale à zéro (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\beta\)</span> = 0). Sous cette hypothèse nulle, le MS attendu pour la composante de régression est égal à un. Ainsi, le rapport des deux composantes de variance <span class="math inline">\(MS_{regression}\)</span> et <span class="math inline">\(MS_{residual}\)</span> est également égal à 1. Si, pour les données de notre échantillon, le rapport est supérieur à un, il y a des raisons de penser que l’hypothèse nulle est fausse. Si les quatre hypothèses de régression se vérifient, le rapport de <span class="math inline">\(MS_{regression}\)</span> et <span class="math inline">\(MS_{residual}\)</span> suivra une distribution <span class="math inline">\(F\)</span> avec <span class="math inline">\(ddl_{regression}\)</span> et <span class="math inline">\(ddl_{residual}\)</span> degrés de liberté.</p>
<p>Le tableau ANOVA permet donc de vérifier s’il existe une relation linéaire entre <span class="math inline">\(Y\)</span> et <span class="math inline">\(X\)</span>.</p>
</section>
<section id="commande-summary" class="level4" data-number="4.3.1.2">
<h4 data-number="4.3.1.2" class="anchored" data-anchor-id="commande-summary"><span class="header-section-number">4.3.1.2</span> Commande <code>summary</code></h4>
<p>La commande <code>summary</code> donne le résultat suivant:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = abundance ~ larea + ldist + lldist + year + altitude + 
    fgraze, data = loyn)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.8992  -2.7245  -0.2772   2.7052  11.2811 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  36.68025  115.16348   0.319   0.7515    
larea         2.96755    0.65287   4.545 3.97e-05 ***
ldist         0.14456    1.19334   0.121   0.9041    
lldist        0.34641    0.92835   0.373   0.7107    
year         -0.01277    0.05803  -0.220   0.8267    
altitude      0.01070    0.02390   0.448   0.6565    
fgraze2       0.52851    3.25221   0.163   0.8716    
fgraze3       0.06601    2.95871   0.022   0.9823    
fgraze4      -1.24877    3.19838  -0.390   0.6980    
fgraze5     -12.47309    4.77827  -2.610   0.0122 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.105 on 46 degrees of freedom
Multiple R-squared:  0.7295,    Adjusted R-squared:  0.6766 
F-statistic: 13.78 on 9 and 46 DF,  p-value: 2.115e-10</code></pre>
</div>
</div>
<p>La première partie de la sortie indique le modèle appliqué et quelques informations de base sur les résidus.</p>
<p>La partie située sous «Coefficients» donne les paramètres de régression estimés, les erreurs standard, les <span class="math inline">\(t\)</span>-values et les <span class="math inline">\(p\)</span>-values. La seule partie déroutante de ce résultat est peut-être l’absence de graze niveau 1. Il est utilisé comme base de référence. Ainsi, une parcelle ayant le niveau 2 de graze a 0,52 oiseaux (densité) de plus qu’une parcelle ayant le niveau 1, et une parcelle ayant le niveau 5 de graze a 12,4 oiseaux de moins qu’une parcelle ayant le niveau 1. Les <span class="math inline">\(p\)</span>-values correspondantes indiquent si une parcelle est significativement différente du niveau 1. Notez que vous ne devez pas évaluer l’importance d’un facteur en fonction des <span class="math inline">\(p\)</span>-values individuelles. Nous proposerons une meilleure méthode à cet effet dans un instant. Vous ne devez pas laisser de côté les niveaux individuels d’une variable nominale. Ils sont tous pris en compte ou vous laissez tomber la variable entière. La dernière partie du code donne le <span class="math inline">\(R^2\)</span> et le <span class="math inline">\(R^2\)</span> ajusté (pour la sélection du modèle). Le reste de la sortie devrait, je l’espère, vous être familier.</p>
</section>
<section id="commande-drop1" class="level4" data-number="4.3.1.3">
<h4 data-number="4.3.1.3" class="anchored" data-anchor-id="commande-drop1"><span class="header-section-number">4.3.1.3</span> Commande <code>drop1</code></h4>
<p>La fonction <code>drop1</code> fais exactement ce que son nom indique, elle élimine une variable, chacune à son tour et reévalue le modèle:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(model1, <span class="at">test=</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
abundance ~ larea + ldist + lldist + year + altitude + fgraze
         Df Sum of Sq    RSS    AIC F value   Pr(&gt;F)    
&lt;none&gt;                1714.4 211.60                     
larea     1    770.01 2484.4 230.38 20.6603 3.97e-05 ***
ldist     1      0.55 1715.0 209.62  0.0147  0.90411    
lldist    1      5.19 1719.6 209.77  0.1392  0.71075    
year      1      1.81 1716.2 209.66  0.0485  0.82675    
altitude  1      7.47 1721.9 209.85  0.2004  0.65650    
fgraze    4    413.50 2127.9 215.70  2.7736  0.03799 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Le modèle complet a une somme des carrés de 1714,4. Chaque fois, <span class="math inline">\(un\)</span> terme est supprimé à tour de rôle et la somme des carrés résiduelle est calculée à chaque fois. Celles-ci sont ensuite utilisées pour calculer une statistique <span class="math inline">\(F\)</span> et une <span class="math inline">\(p\)</span>-value correspondante. Par exemple, pour obtenir le résultat de la première ligne, R ajuste deux modèles. Le premier modèle contient toutes les variables explicatives et le second modèle toutes, sauf <span class="math inline">\(larea\)</span>. Il utilise ensuite les sommes des carrés résiduels de chaque modèle dans la statistique <span class="math inline">\(F\)</span> suivante: <span class="math display">\[ F=\frac{(SCR_1 - SCR_2)/(p-q)}{SCR_2/(n-p)} \]</span></p>
<p>Les termes <span class="math inline">\(SCR_1\)</span> et <span class="math inline">\(SCR_2\)</span> sont les sommes des carrés résiduels du modèle <code>model1</code> et du modèle <span class="math inline">\(model2\)</span> , respectivement, et <span class="math inline">\(n\)</span> est le nombre d’observations. Le nombre de paramètres dans les modèles 2 et 1 est respectivement <span class="math inline">\(p\)</span> et <span class="math inline">\(q (p &gt; q)\)</span>. Les modèles sont imbriqués dans le sens où un modèle est obtenu à partir d’un autre en fixant certains paramètres à 0. L’hypothèse nulle sous-jacente à cette statistique est que les paramètres omis sont égaux à 0 : <span class="math inline">\(H_0: \beta = 0\)</span>. Plus la valeur de la statistique <span class="math inline">\(F\)</span> est élevée, plus il y a de preuves pour rejeter cette hypothèse. En fait, la statistique <span class="math inline">\(F\)</span> suit une distribution <span class="math inline">\(F\)</span>, en supposant l’homogénéité, la normalité, l’indépendance et l’absence de modèles résiduels. Dans ce cas, nous pouvons rejeter l’hypothèse nulle.</p>
<p>Dans la régression linéaire, les <span class="math inline">\(p\)</span>-values de la fonction <code>drop1</code> sont les mêmes que celles obtenues par la statistique <span class="math inline">\(t\)</span> de la commande <code>summary</code>, mais pour les GLM non gaussiens, ce n’est pas nécessairement le cas. L’hypothèse nulle sous-jacente à la statistique <span class="math inline">\(F\)</span> est que le paramètre de régression du terme qui a été abandonné est égal à 0. Fondamentalement, nous comparons un modèle complet et (à plusieurs reprises) un modèle imbriqué.</p>
<p>Si le modèle comporte plusieurs variables nominales, la fonction <code>drop1</code> donne une <span class="math inline">\(p\)</span>-value pour chaque variable, ce qui est pratique.</p>
</section>
<section id="commande-anova" class="level4" data-number="4.3.1.4">
<h4 data-number="4.3.1.4" class="anchored" data-anchor-id="commande-anova"><span class="header-section-number">4.3.1.4</span> Commande <code>anova</code></h4>
<p>La commande <code>anova</code> donne le résultat suivant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: abundance
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
larea      1 3471.0  3471.0 93.1303 1.247e-12 ***
ldist      1   65.5    65.5  1.7568  0.191565    
lldist     1  136.5   136.5  3.6630  0.061868 .  
year       1  458.8   458.8 12.3109  0.001019 ** 
altitude   1   78.2    78.2  2.0979  0.154281    
fgraze     4  413.5   103.4  2.7736  0.037992 *  
Residuals 46 1714.4    37.3                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>R utilise le carré moyen du modèle complet (37,3) et le carré moyen de chaque ligne dans un test <span class="math inline">\(F\)</span> similaire au précédent. Ainsi, 93,13 est obtenu en divisant 3471,0 par 37,3, et 1,75 est égal à 65,5/37,3. Les carrés moyens sont calculés à partir de la somme des carrés divisée par les degrés de liberté. La somme des carrés sur la première ligne, 3471,0, est la somme des carrés de régression du modèle <span class="math inline">\(abundance_i = \alpha + \beta \times larea + \epsilon_i\)</span>. Les 65,5 de la deuxième ligne représentent la diminution de la somme des carrés résiduels si <span class="math inline">\(ldist\)</span> est ajouté à ce modèle (pour le voir, ajustez un modèle avec seulement l’ordonnée à l’origine et <span class="math inline">\(larea\)</span>, et un modèle avec l’ordonnée à l’origine, <span class="math inline">\(larea\)</span>, et <span class="math inline">\(ldist\)</span> et comparez les deux sommes des carrés résiduels obtenus à partir des commandes anova ; la différence sera de 65,5). L’avantage de cette approche est que la dernière ligne nous donne une <span class="math inline">\(p\)</span>-value pour la variable nominale <code>graze</code> (puisqu’il s’agit de la dernière variable ajoutée), et nous en avons besoin pour déterminer si <code>graze</code> est significatif. L’inconvénient de cette méthode de test est que les <span class="math inline">\(p\)</span>-value dépendent de l’ordre des variables: Changez l’ordre et vous obtiendrez une conclusion différente. Notez que la dernière ligne de la commande <code>anova</code> et la ligne <code>drop1</code> sont identiques. Cela s’explique par le fait que les mêmes modèles imbriqués sont comparés. La fonction <code>anova</code> peut également être utilisée pour comparer des modèles imbriqués. Supposons que nous ajustions un modèle linéaire avec toutes les variables explicatives, et un modèle avec toutes les variables explicatives, à l’exception de <code>graze</code>. Ces modèles sont imbriqués car le second modèle est un cas particulier du premier, en supposant que les quatre paramètres de régression pour les niveaux de <code>graze</code> sont égaux à zéro (voir ci-dessous).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(abundance <span class="sc">~</span> larea <span class="sc">+</span> ldist <span class="sc">+</span> lldist <span class="sc">+</span> year <span class="sc">+</span> altitude, <span class="at">data =</span> loyn)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: abundance ~ larea + ldist + lldist + year + altitude + fgraze
Model 2: abundance ~ larea + ldist + lldist + year + altitude
  Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
1     46 1714.4                              
2     50 2127.9 -4    -413.5 2.7736 0.03799 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>L’hypothèse nulle sous-jacente à la statistique <span class="math inline">\(F\)</span> est que les quatre paramètres de régression pour <span class="math inline">\(graze\)</span> (niveaux 2-5) sont égaux à 0, ce qui est rejeté à 5%. Notez que la <span class="math inline">\(p\)</span>-value est identique à la <span class="math inline">\(p\)</span>-value obtenue pour le même test avec la commande <code>anova(M1)</code>. Alors pourquoi faire la comparaison ? L’avantage de la commande <code>anova(M1, M2)</code> est que nous pouvons contrôler quels termes sont éliminés. Ceci est particulièrement utile dans le cas d’interactions multiples.</p>
</section>
</section>
<section id="sélection-de-modèle" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="sélection-de-modèle"><span class="header-section-number">4.3.2</span> Sélection de modèle</h3>
<p>Toutes les variables explicatives ne sont pas significativement différentes de 0, comme le montrent les <span class="math inline">\(p\)</span>-values des statistiques <span class="math inline">\(t\)</span> (commande <code>summary</code>) ou les <span class="math inline">\(p\)</span>-value de la statistique <span class="math inline">\(F\)</span> (commande <code>drop1</code>) présentées ci-dessus. Si l’objectif de l’analyse est de comprendre quelles variables explicatives déterminent l’abondance des oiseaux, nous pourrions alors décider d’abandonner les variables explicatives qui ne sont pas significatives. Il s’agit là encore d’un sujet sur lequel les statisticiens ne sont pas d’accord. Il existe essentiellement trois approches principales :</p>
<ol type="1">
<li>Abandonner les variables explicatives une à une sur la base de procédures de test d’hypothèses.</li>
<li>Abandonner les variables explicatives une à une (et à chaque fois refaire le modèle) et utiliser un critère de sélection de modèle comme l’AIC ou le BIC pour décider du modèle optimal.</li>
<li>Spécifier les modèles choisis a priori et comparer ces modèles entre eux.</li>
</ol>
<p>La première approche consiste à éliminer le terme le moins significatif, soit sur la base des valeurs <span class="math inline">\(t\)</span> et <span class="math inline">\(p\)</span>-values obtenues par la commande <code>summary</code>, soit par la commande <code>anova</code> pour comparer les modèles imbriqués s’il y a des variables nominales et/ou des interactions. Dans la deuxième approche, nous utilisons un critère de sélection comme le critère d’information d’Akaike (AIC). Il mesure la qualité de l’ajustement et la complexité du modèle. L’avantage de l’AIC est que R dispose d’outils permettant d’appliquer une sélection automatique vers l’avant (forward selection) ou vers l’arrière (backward selection) sur la base de l’AIC, ce qui facilite la vie! L’inconvénient est que l’AIC peut être conservateur et qu’il peut être nécessaire de procéder à un réglage fin (en utilisant les résultats des tests d’hypothèse de la première approche) une fois que l’AIC a sélectionné un modèle optimal. Une sélection en arrière est appliquée par la commande <code>step(model1)</code>, et sa sortie est donnée comme suit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=211.6
abundance ~ larea + ldist + lldist + year + altitude + fgraze

           Df Sum of Sq    RSS    AIC
- ldist     1      0.55 1715.0 209.62
- year      1      1.81 1716.2 209.66
- lldist    1      5.19 1719.6 209.77
- altitude  1      7.47 1721.9 209.85
&lt;none&gt;                  1714.4 211.60
- fgraze    4    413.50 2127.9 215.70
- larea     1    770.01 2484.4 230.38

Step:  AIC=209.62
abundance ~ larea + lldist + year + altitude + fgraze

           Df Sum of Sq    RSS    AIC
- year      1      1.73 1716.7 207.68
- altitude  1      7.07 1722.0 207.85
- lldist    1      8.57 1723.5 207.90
&lt;none&gt;                  1715.0 209.62
- fgraze    4    413.28 2128.2 213.71
- larea     1    769.64 2484.6 228.38

Step:  AIC=207.68
abundance ~ larea + lldist + altitude + fgraze

           Df Sum of Sq    RSS    AIC
- lldist    1      8.32 1725.0 205.95
- altitude  1      9.71 1726.4 205.99
&lt;none&gt;                  1716.7 207.68
- fgraze    4    848.77 2565.5 222.18
- larea     1    790.20 2506.9 226.88

Step:  AIC=205.95
abundance ~ larea + altitude + fgraze

           Df Sum of Sq    RSS    AIC
- altitude  1      5.37 1730.4 204.12
&lt;none&gt;                  1725.0 205.95
- fgraze    4    914.23 2639.3 221.76
- larea     1   1130.78 2855.8 232.18

Step:  AIC=204.12
abundance ~ larea + fgraze

         Df Sum of Sq    RSS    AIC
&lt;none&gt;                1730.4 204.12
- fgraze  4    1136.5 2866.9 224.40
- larea   1    1153.8 2884.2 230.73</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = abundance ~ larea + fgraze, data = loyn)

Coefficients:
(Intercept)        larea      fgraze2      fgraze3      fgraze4      fgraze5  
    15.7164       3.1474       0.3826      -0.1893      -1.5916     -11.8938  </code></pre>
</div>
</div>
<p>La première partie du code montre que le modèle contenant toutes les variables explicatives a un AIC de 211,6 avant l’élimination de chaque terme. Plus l’AIC est faible, meilleur est le modèle. Par conséquent, nous devrions abandonner <code>ldist</code>. La procédure se poursuit en éliminant <code>year</code>, <code>lldist</code> et <code>altitude</code>.</p>
<p>À ce stade, aucun autre terme n’est supprimé; le modèle avec <code>larea</code> et <code>fgraze</code> a un AIC de 204,12, et la suppression de n’importe lequel de ces termes donne un AIC plus élevé. Cela signifie que le modèle optimal basé sur l’AIC contient <code>fgraze</code> et <code>larea</code>. Vous devriez réappliquer ce modèle et voir si les deux termes sont significatifs. Notez que la commande <code>summary</code> et la commande <code>anova</code> sont toutes deux nécessaires pour cela. Les deux termes sont significatifs au niveau de 5%. Vous pouvez également essayer de voir si l’ajout d’une interaction entre <code>larea</code> et <code>fgraze</code> améliore le modèle. Vous devriez pouvoir obtenir une <span class="math inline">\(p\)</span>-value pour ce terme d’interaction.</p>
</section>
<section id="exercice" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="exercice"><span class="header-section-number">4.3.3</span> Exercice</h3>
<ol type="1">
<li>Réevaluez le modèle en prenant en compte uniquement <code>fgraze</code> et <code>larea</code>. Introduisez ensuite des interaction dans le modèle.</li>
</ol>
</section>
<section id="validation-de-modèle" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="validation-de-modèle"><span class="header-section-number">4.3.4</span> Validation de modèle</h3>
<section id="conditions-de-validité-du-modèle-linéaire" class="level4" data-number="4.3.4.1">
<h4 data-number="4.3.4.1" class="anchored" data-anchor-id="conditions-de-validité-du-modèle-linéaire"><span class="header-section-number">4.3.4.1</span> Conditions de validité du modèle linéaire</h4>
<section id="normalité" class="level5" data-number="4.3.4.1.1">
<h5 data-number="4.3.4.1.1" class="anchored" data-anchor-id="normalité"><span class="header-section-number">4.3.4.1.1</span> Normalité</h5>
<p>L’hypothèse de normalité signifie que si nous répétons l’échantillonnage plusieurs fois dans les mêmes conditions environnementales, les observations seront normalement distribuées pour chaque valeur de <span class="math inline">\(X\)</span>. Plusieurs auteurs affirment que la violation de la normalité n’est pas un problème grave en raison de la théorême de la limite centrale. Certains auteurs affirment même que l’hypothèse de normalité n’est pas du tout nécessaire si la taille de l’échantillon est suffisamment grande. <strong>La normalité à chaque valeur</strong> <span class="math inline">\(X\)</span> doit être vérifiée en réalisant un histogramme de toutes les observations à cette valeur <span class="math inline">\(X\)</span> particulière. Très souvent, nous ne disposons pas de plusieurs observations (sous-échantillons) pour chaque valeur <span class="math inline">\(X\)</span>. Dans ce cas, le mieux que nous puissions faire est de regrouper tous les résidus et de réaliser un histogramme des résidus regroupés; la normalité des résidus regroupés est rassurante, mais elle n’implique pas la normalité des données de la population.</p>
<p>Nous expliquons également comment <em>ne pas</em> vérifier la normalité, car le concept sous-jacent de normalité est très mal compris par de nombreuses personnes. Le modèle de régression linéaire exige la normalité des données, et donc des résidus pour <em>chaque</em> valeur <span class="math inline">\(X\)</span>. Les résidus représentent l’information qui reste après avoir éliminé l’effet des variables explicatives. Cependant, les données brutes <span class="math inline">\(Y\)</span> (<span class="math inline">\(Y\)</span> représente la variable réponse) contiennent les effets des variables explicatives. Pour évaluer la normalité des données <span class="math inline">\(Y\)</span>, il est donc trompeur de fonder son jugement uniquement sur un histogramme de toutes les données <span class="math inline">\(Y\)</span>. La situation est différente si vous disposez d’un grand nombre de réplicats pour chaque valeur <span class="math inline">\(X\)</span>.</p>
<p>En résumé, à moins que vous ne disposiez d’observations répétées pour chaque valeur <span class="math inline">\(X\)</span>, vous ne devez pas fonder votre jugement de normalité des données sur un histogramme des données brutes. Il faudrait plutôt appliquer un modèle et inspecter les résidus.</p>
</section>
<section id="hétérogénéité" class="level5" data-number="4.3.4.1.2">
<h5 data-number="4.3.4.1.2" class="anchored" data-anchor-id="hétérogénéité"><span class="header-section-number">4.3.4.1.2</span> Hétérogénéité</h5>
<p>Il est possible de s’en sortir avec une petite quantité de non-normalité. Cependant, l’hétérogénéité (violation de l’homogénéité), également appelée hétéroscédasticité, se produit si la dispersion des données n’est pas la même pour chaque valeur <span class="math inline">\(X\)</span>. Ceci peut être vérifié en comparant la dispersion des résidus pour les différentes valeurs <span class="math inline">\(X\)</span>. Comme dans la sous-section précédente, nous pouvons affirmer que la plupart du temps, nous n’avons pas d’observations multiples pour chaque valeur <span class="math inline">\(X\)</span>, du moins pas dans la plupart des études sur le terrain. La seule chose que nous puissions faire est de regrouper tous les résidus et de les comparer aux valeurs ajustées. L’écart devrait être à peu près le même dans toute la gamme des valeurs ajustées.</p>
<p>Il est possible d’utiliser des tests pour vérifier l’homogénéité des données. Cependant la plupart d’entre eux se basent sur la normalité de ces valeurs (par exemple le test de Barlett). Mon avis personnel est de prioriser les outils graphiques de visualisation des résidus. Il est aussi possible d’effectuer une regression linéaire, même en présence d’une faible hétérogénéité cependant cela n’est pas le cas lorsqu’on observe une forte hétérogénéité.</p>
</section>
<section id="x-fixe" class="level5" data-number="4.3.4.1.3">
<h5 data-number="4.3.4.1.3" class="anchored" data-anchor-id="x-fixe"><span class="header-section-number">4.3.4.1.3</span> X fixe</h5>
<p>Le <span class="math inline">\(X\)</span> fixe est une hypothèse impliquant que les variables explicatives sont déterministes. Vous connaissez à l’avance les valeurs de chaque échantillon. C’est par exemple le cas si l’on sélectionne a priori des sites avec une valeur de température prédéfinie ou si l’on choisit la quantité de toxine dans un bassin. Mais si vous allez sur le terrain, que vous prélevez un échantillon au hasard et que vous mesurez ensuite la température ou la concentration de toxines, il s’agit alors d’un processus aléatoire.</p>
<p>La violation grave de cette hypothèse entraîne des paramètres de régression biaisés. L’expression «biaisé» signifie que la valeur attendue du paramètre estimé n’est pas égale à la valeur de la population. Heureusement, nous pouvons ignorer le problème si l’erreur dans la détermination de la variable explicative est faible par rapport à l’étendue de la variable explicative. Ainsi, si vous avez 20 échantillons où la température varie entre 15 et 20 degrés Celsius, et que l’erreur de votre thermomètre est de 0,1, tout va bien. Mais, par exemple, dans le cas de la détermination de l’âge des baleines, celà peut être une autre histoire, car l’âge varie de 0 à 40 ans, mais l’erreur sur la lecture de l’âge peut (ou non) être de quelques années. Il existe des solutions élégantes à ce problème telles que le bootstrapping que nous n’aborderons pas ici.</p>
</section>
<section id="indépendance" class="level5" data-number="4.3.4.1.4">
<h5 data-number="4.3.4.1.4" class="anchored" data-anchor-id="indépendance"><span class="header-section-number">4.3.4.1.4</span> Indépendance</h5>
<p>La violation de l’indépendance est le problème le plus grave car elle invalide des tests importants tels que le test <span class="math inline">\(F\)</span> et le test <span class="math inline">\(t\)</span>. La question clé est donc de savoir comment identifier un manque d’indépendance et comment y remédier. Il y a violation de l’indépendance si la valeur <span class="math inline">\(Y\)</span> à <span class="math inline">\(X_i\)</span> est influencée par d’autres <span class="math inline">\(X_i\)</span> (Quinn et Keough, 2002).</p>
<p>En fait, cela peut se produire de deux manières: soit un modèle inapproprié, soit une structure de dépendance due à la nature des données elles-mêmes. Supposons que vous ajustiez une ligne droite à un ensemble de données qui présente un schéma non linéaire clair entre <span class="math inline">\(Y\)</span> et <span class="math inline">\(X\)</span> dans un nuage de points. Si vous tracez les résidus en fonction de <span class="math inline">\(X\)</span>, vous verrez un schéma clair dans les résidus: les résidus des échantillons ayant des valeurs <span class="math inline">\(X\)</span> similaires sont tous positifs ou négatifs. Une mauvaise formulation du modèle peut donc entraîner une violation de l’indépendance. La solution consiste à améliorer le modèle ou à le transformer pour «linéariser la relation».</p>
<p>D’autres causes de violation de l’indépendance sont dues à la nature des données elles-mêmes. Ce que vous mangez maintenant dépend de ce que vous mangiez il y a une minute. S’il pleut à 100 m dans l’air, il pleuvra aussi à 200 m dans l’air. Si nous avons un grand nombre d’oiseaux à l’instant <span class="math inline">\(t\)</span>, il est probable qu’il y avait également un grand nombre d’oiseaux à l’instant <span class="math inline">\(t - 1\)</span>. Il en va de même pour des emplacements spatiaux proches les uns des autres. Ce type de violation de l’indépendance peut être résolu en incorporant une structure de dépendance temporelle ou spatiale entre les observations (ou les résidus) dans le modèle.</p>
</section>
</section>
<section id="evaluation-du-modèle-précédent" class="level4" data-number="4.3.4.2">
<h4 data-number="4.3.4.2" class="anchored" data-anchor-id="evaluation-du-modèle-précédent"><span class="header-section-number">4.3.4.2</span> Evaluation du modèle précédent</h4>
<p>Une fois que le modèle optimal a été trouvé, il est temps d’appliquer une validation du modèle. Ce processus comprend (au minimum) les étapes suivantes:</p>
<ul>
<li>Tracer les résidus (standardisés) par rapport aux valeurs ajustées pour évaluer l’homogénéité.</li>
<li>Faites un histogramme des résidus pour vérifier la normalité. Vous pouvez également utiliser un QQ-plot.</li>
<li>Tracez les résidus en fonction de chaque variable explicative utilisée dans le modèle. Si vous observez un schema (structure non aléatoire), vous ne respectez pas l’hypothèse d’indépendance.</li>
<li>Représentez les résidus par rapport à chaque variable explicative non utilisée dans le modèle. Si vous observez un schema, incluez la variable explicative omise et relancez le modèle. Si les motifs de résidus disparaissent, incluez le terme, même s’il n’est pas significatif.</li>
<li>Évaluer le modèle en fonction des observations influentes. La fonction de distance de Cook est un outil utile.</li>
</ul>
<p>Voici quelques problèmes courants et leurs solutions:</p>
<p>1. Il y a une violation de l’homogénéité indiquée par les résidus par rapport aux valeurs ajustées. Cependant, les résidus tracés en fonction des variables explicatives ne présentent pas de schema aléatoire clair. Les solutions possibles sont une transformation de la variable réponse, l’ajout d’interactions ou l’utilisation d’une modélisation linéaire généralisée avec une distribution de Poisson (si les données sont des comptages).</p>
<p>2. Il y a une violation de l’homogénéité et les résidus tracés en fonction des variables explicatives présentent un schéma aléatoire clair. Les solutions possibles sont les suivantes. Ajoutez des interactions ou des termes non linéaires de la variable explicative (par exemple, des termes quadratiques). Vous pouvez également envisager une modélisation additive généralisée.</p>
<p>3. Il n’y a pas de violation de l’homogénéité, mais il existe des schémas clairs dans les résidus tracés en fonction des variables explicatives. Solutions possibles : Envisager une transformation des variables explicatives ou appliquer une modélisation additive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(abundance <span class="sc">~</span> larea <span class="sc">+</span> fgraze, <span class="at">data =</span> loyn)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(model3)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(E)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(E)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(E)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y =</span> E, <span class="at">x =</span> loyn<span class="sc">$</span>larea, <span class="at">xlab =</span> <span class="st">"area"</span>, <span class="at">ylab=</span><span class="st">"residus"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(E <span class="sc">~</span> loyn<span class="sc">$</span>fgraze, <span class="at">xlab=</span><span class="st">"graze"</span>, <span class="at">ylab=</span><span class="st">"residus"</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>il existe des preuves d’hétérogénéité (comme le montre le graphique des résidus par rapport aux valeurs ajustées) et de non-normalité. Il semble qu’il y ait moins de dispersion sur les sites dont le niveau de <code>graze</code> est de 5. Sur la base du graphique qui montre les résidus par rapport à <code>larea</code>, il semble que nous ayons une certaine violation de l’indépendance.</p>
</section>
</section>
<section id="visualisation-du-modèle" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="visualisation-du-modèle"><span class="header-section-number">4.3.5</span> Visualisation du modèle</h3>
<p>Il est parfois utile d’inclure une représentation graphique de votre modèle; un graphique peut en dire plus que plusieurs lignes de texte. C’est pourquoi nous avons donné un graphique qui montre ce que l’on peut attendre d’un modèle. Les abondances observées sont représentées en fonction de <code>larea</code>. Chaque ligne représente un niveau de pâturage et la ligne la plus basse correspond au niveau 5. Il est également possible d’utiliser des couleurs différentes pour les lignes ou des symboles différents pour les points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">larea=</span>loyn<span class="sc">$</span>larea[loyn<span class="sc">$</span>graze<span class="sc">==</span><span class="dv">1</span>], <span class="at">fgraze=</span><span class="st">"1"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">larea=</span>loyn<span class="sc">$</span>larea[loyn<span class="sc">$</span>graze<span class="sc">==</span><span class="dv">2</span>], <span class="at">fgraze=</span><span class="st">"2"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">larea=</span>loyn<span class="sc">$</span>larea[loyn<span class="sc">$</span>graze<span class="sc">==</span><span class="dv">3</span>], <span class="at">fgraze=</span><span class="st">"3"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">larea=</span>loyn<span class="sc">$</span>larea[loyn<span class="sc">$</span>graze<span class="sc">==</span><span class="dv">4</span>], <span class="at">fgraze=</span><span class="st">"4"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>d5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">larea=</span>loyn<span class="sc">$</span>larea[loyn<span class="sc">$</span>graze<span class="sc">==</span><span class="dv">5</span>], <span class="at">fgraze=</span><span class="st">"5"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3, <span class="at">newdata=</span>d1)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3, <span class="at">newdata=</span>d2)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3, <span class="at">newdata=</span>d3)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3, <span class="at">newdata=</span>d4)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3, <span class="at">newdata=</span>d5)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(loyn<span class="sc">$</span>larea, loyn<span class="sc">$</span>abundance)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d1<span class="sc">$</span>larea, p1, <span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d2<span class="sc">$</span>larea, p2, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d3<span class="sc">$</span>larea, p3, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d4<span class="sc">$</span>larea, p4, <span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d5<span class="sc">$</span>larea, p5, <span class="at">lty=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Les lignes de la figure sont parallèles parce qu’il n’y a pas de terme d’interaction entre larea et fgraze dans le modèle. Si un terme d’interaction était significatif, les lignes auraient des pentes différentes.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./exploration.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploration des données</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./glm.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modèles linéaires généralisés</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Modélisation des données biologiques avec R écris par Anicet Ebou</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>